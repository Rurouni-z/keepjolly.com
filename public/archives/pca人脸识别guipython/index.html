<!doctype html><html lang=zh-cn><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=theme-color content="#fff"><meta name=color-scheme content="light dark"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><title>PCA人脸识别+GUI+python | 悠闲の小屋</title><link rel=stylesheet href=/css/meme.min.css><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.js defer></script><script src=/js/meme.min.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto+Serif+SC:wght@400;500;700&amp;family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" media=print onload='this.media="all"'><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto+Serif+SC:wght@400;500;700&amp;family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap"></noscript><meta name=author content="Rurouni"><meta name=description content="​ 参考：基于PCA的人脸识别方法——特征脸法 参考：人脸识别之主成分分析（PCA） 简易……"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="悠闲の小屋"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="悠闲の小屋"><meta name=msapplication-starturl content="../../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../../icons/mstile-150x150.png"><link rel=manifest href=/manifest.json><link rel=canonical href=https://keepjolly.com/archives/pca%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%ABguipython/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2022-02-22T16:17:36+00:00","dateModified":"2023-05-06T13:51:51+00:00","url":"https://keepjolly.com/archives/pca%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%ABguipython/","headline":"PCA人脸识别+GUI+python","description":"​ 参考：基于PCA的人脸识别方法——特征脸法 参考：人脸识别之主成分分析（PCA） 简易……","inLanguage":"zh-CN","articleSection":"posts","wordCount":1630,"image":["https://keepjolly.com/upload/2022/02/Snipaste_2022-02-22_16-19-23-9bb0ff00b0b647bd9f78e7f0cc5f97e6.png"],"author":{"@type":"Person","description":"知行合一","email":"1366475809@qq.com","image":"https://halo-1310118673.cos.ap-singapore.myqcloud.com/halo/profile%20photo_1647067705220.jpeg","url":"https://keepjolly.com/","name":"Rurouni"},"license":"在保留本文作者及本文链接的前提下，非商业用途随意转载分享(我会高强度自搜的喔👊)。","publisher":{"@type":"Organization","name":"悠闲の小屋","logo":{"@type":"ImageObject","url":"https://halo-1310118673.cos.ap-singapore.myqcloud.com/halo%2Fweb_logo.png"},"url":"https://keepjolly.com/"},"mainEntityOfPage":{"@type":"WebSite","@id":"https://keepjolly.com/"}}</script><meta name=twitter:card content="summary_large_image"><meta property="og:title" content="PCA人脸识别+GUI+python"><meta property="og:description" content="​ 参考：基于PCA的人脸识别方法——特征脸法 参考：人脸识别之主成分分析（PCA） 简易……"><meta property="og:url" content="https://keepjolly.com/archives/pca%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%ABguipython/"><meta property="og:site_name" content="悠闲の小屋"><meta property="og:locale" content="zh"><meta property="og:image" content="https://keepjolly.com/upload/2022/02/Snipaste_2022-02-22_16-19-23-9bb0ff00b0b647bd9f78e7f0cc5f97e6.png"><meta property="og:type" content="article"><meta property="article:published_time" content="2022-02-22T16:17:36+00:00"><meta property="article:modified_time" content="2023-05-06T13:51:51+00:00"><meta property="article:section" content="posts"><meta name=google-site-verification content="mBjLYgXaXR8EAfTNbi4DTVC5KOJuBHpZDsmtgbgC6Rs"></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=/ class=brand>悠闲の小屋</a></div><nav class=nav><ul class=menu id=menu><li class="menu-item active"><a href=/posts/><span class=menu-item-name>文章</span></a></li><li class=menu-item><a href=/tags/><span class=menu-item-name>标签</span></a></li><li class=menu-item><a href=/about/><span class=menu-item-name>关于</span></a></li><li class=menu-item><a id=theme-switcher href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5 242 7a18 18 0 0128 0l48.8 97.5L422.2 70A18 18 0 01442 89.8l-34.5 103.4L505 242a18 18 0 010 28l-97.5 48.8L442 422.2A18 18 0 01422.2 442l-103.4-34.5L270 505a18 18 0 01-28 0l-48.8-97.5L89.8 442A18 18 0 0170 422.2l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8L70 89.8A18 18 0 0189.8 70zM256 128a128 128 0 10.01.0M256 160a96 96 0 10.01.0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412A256 256 0 10181 5a11.5 11.5.0 00-5 20A201.5 201.5.0 0142 399a11.5 11.5.0 00-15 13"/></svg></a></li><li class="menu-item search-item"><form id=search class=search role=search><label for=search-input><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon search-icon"><path d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></label><input type=search id=search-input class=search-input></form><template id=search-result hidden><article class="content post"><h2 class=post-title><a class=summary-title-link></a></h2><summary class=summary></summary><div class=read-more-container><a class=read-more-link>阅读更多 »</a></div></article></template></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=justify data-type=posts data-toc-num=true><h1 class="post-title p-name">PCA人脸识别+GUI+python</h1><nav class=contents></nav><div class="post-body e-content"><p>​
参考：<a href=https://www.chimaoshu.top/%E5%9F%BA%E4%BA%8EPCA%E7%9A%84%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E6%96%B9%E6%B3%95%E2%80%94%E2%80%94%E7%89%B9%E5%BE%81%E8%84%B8%E6%B3%95/ target=_blank rel=noopener>基于PCA的人脸识别方法——特征脸法</a></p><p>参考：<a href=https://zhuanlan.zhihu.com/p/26652435 target=_blank rel=noopener>人脸识别之主成分分析（PCA）</a></p><p><strong>简易</strong> 系统展示
<img src=/upload/2022/02/Snipaste_2022-02-22_16-19-23-9bb0ff00b0b647bd9f78e7f0cc5f97e6.png alt></p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span> <span class=k>as</span> <span class=nn>cv</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PyQt5</span> <span class=kn>import</span> <span class=n>QtCore</span><span class=p>,</span> <span class=n>QtWidgets</span><span class=p>,</span> <span class=n>QtGui</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PyQt5.QtWidgets</span> <span class=kn>import</span> <span class=n>QApplication</span><span class=p>,</span> <span class=n>QMainWindow</span><span class=p>,</span> <span class=n>QFileDialog</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>root_dir</span> <span class=o>=</span> <span class=s1>&#39;FaceDB_orl&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>createDataBase</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;--------正在获取数据--------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>path1</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>dirpath</span><span class=p>,</span> <span class=n>dirnames</span><span class=p>,</span> <span class=n>filenames</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>filenames</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>temp_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>dirpath</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>path1</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>temp_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>img_path</span> <span class=ow>in</span> <span class=n>path1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=o>=</span> <span class=n>cv</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=n>img_path</span><span class=p>,</span> <span class=n>cv</span><span class=o>.</span><span class=n>IMREAD_GRAYSCALE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># img = cv.resize(img, crop_size)</span>
</span></span><span class=line><span class=cl>        <span class=n>temp</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>temp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># print(X.shape[0])  # m个数据</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;--------获取数据结束--------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>X</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=o>.</span><span class=n>T</span>  <span class=c1># (row*col, 400)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>eigenface</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>k1</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>k2</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;--------正在特征提取--------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>  <span class=c1># 400</span>
</span></span><span class=line><span class=cl>    <span class=c1># 计算平均脸及中心化</span>
</span></span><span class=line><span class=cl>    <span class=n>X_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># (r*l, 1)</span>
</span></span><span class=line><span class=cl>    <span class=n>X_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>X_mean</span><span class=p>,</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>X</span> <span class=o>=</span> <span class=n>X</span> <span class=o>-</span> <span class=n>X_mean</span>  <span class=c1># (r*l, 400)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 计算协方差矩阵的特征值、特征向量</span>
</span></span><span class=line><span class=cl>    <span class=n>L_mat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>X</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>m</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># (400, 400)</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=n>W</span><span class=p>,</span> <span class=n>V</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>eig</span><span class=p>(</span><span class=n>L_mat</span><span class=p>)</span>  <span class=c1># 求取特征向量eiv以及特征值eic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 取出特征值大的特征向量 作为特征脸</span>
</span></span><span class=line><span class=cl>    <span class=n>L_eig_vec</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>k1</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>  <span class=c1># 根据特征值的值来选取向量</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>V</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>W</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>k1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>L_eig_vec</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>V</span><span class=p>[:,</span> <span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>k2</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>  <span class=c1># 选取从大到小的k2个向量</span>
</span></span><span class=line><span class=cl>        <span class=n>index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>W</span><span class=p>)[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>L_eig_vec</span> <span class=o>=</span> <span class=n>V</span><span class=p>[</span><span class=n>index</span><span class=p>[:</span><span class=n>k2</span><span class=p>],</span> <span class=p>:]</span>  <span class=c1># (k2, 400)</span>
</span></span><span class=line><span class=cl>    <span class=n>L_eig_vec</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>L_eig_vec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(L_eig_vec.shape)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 得到协方差矩阵的特征向量组成的投影子空间(脸空间)</span>
</span></span><span class=line><span class=cl>    <span class=n>Ei_Face</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>L_eig_vec</span><span class=o>.</span><span class=n>T</span><span class=p>)</span>  <span class=c1># (r*l, 399)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;--------特征提取结束--------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>X_mean</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>Ei_Face</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>recognition</span><span class=p>(</span><span class=n>TestImage</span><span class=p>,</span> <span class=n>X_mean</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>Ei_Face</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;----------正在识别----------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 将训练数据投影到脸空间内</span>
</span></span><span class=line><span class=cl>    <span class=n>EI_Num</span> <span class=o>=</span> <span class=n>Ei_Face</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>  <span class=c1># 合格个数 m</span>
</span></span><span class=line><span class=cl>    <span class=n>ProjectImage</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>Ei_Face</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span> <span class=p>:</span><span class=n>EI_Num</span><span class=p>])</span>  <span class=c1># (m, m) 每一列是一个特征脸</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 读取输入图片 灰度读取</span>
</span></span><span class=line><span class=cl>    <span class=n>input_image</span> <span class=o>=</span> <span class=n>cv</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=n>TestImage</span><span class=p>,</span> <span class=n>cv</span><span class=o>.</span><span class=n>IMREAD_GRAYSCALE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span> <span class=o>=</span> <span class=n>input_image</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># (row*col, 1)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 输入图片 中心化 同PCA的第一步</span>
</span></span><span class=line><span class=cl>    <span class=n>difference</span> <span class=o>=</span> <span class=n>image</span> <span class=o>-</span> <span class=n>X_mean</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(difference)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 输入图片投影到脸空间中 同PCA的最后一步</span>
</span></span><span class=line><span class=cl>    <span class=n>ProjectedTestImage</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>difference</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>Ei_Face</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>  <span class=c1># (399, 1) 变成列向量</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(ProjectedTestImage.shape)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 计算欧式距离 将每行数据(axis=0) - 输入图片 计算欧式距离</span>
</span></span><span class=line><span class=cl>    <span class=n>Euclidean_dist</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>ProjectedTestImage</span> <span class=o>-</span> <span class=n>ProjectImage</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 识别图片 距离最相近</span>
</span></span><span class=line><span class=cl>    <span class=n>Recognized_index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmin</span><span class=p>(</span><span class=n>Euclidean_dist</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># print(Euclidean_dist[Recognized_index])</span>
</span></span><span class=line><span class=cl>    <span class=n>OutputName</span> <span class=o>=</span> <span class=n>Recognized_index</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;----------识别结束----------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>OutputName</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PcaUI</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img_path</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>k1</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>k2</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>setUI</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>Form</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>Form</span><span class=o>.</span><span class=n>setObjectName</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>Form</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>600</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 选择特征获取方式：按值分类 [  ]  按序分类  [   ]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_1</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_1</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>250</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>40</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_2</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_2</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>390</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>40</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_3</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_3</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>640</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>40</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_1</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QTextEdit</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_1</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>465</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>28</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_2</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QTextEdit</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_2</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>715</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>28</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># 选择测试图片： [   ]    浏览文件</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label2</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label2</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>250</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>40</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit2</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QTextEdit</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit2</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>390</span><span class=p>,</span> <span class=mi>158</span><span class=p>,</span> <span class=mi>280</span><span class=p>,</span> <span class=mi>28</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton2</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QPushButton</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton2</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>773</span><span class=p>,</span> <span class=mi>154</span><span class=p>,</span> <span class=mi>71</span><span class=p>,</span> <span class=mi>31</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># 测试图片   预测图片   开始识别</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_3</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_3</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>250</span><span class=p>,</span> <span class=mi>230</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>40</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>250</span><span class=p>,</span> <span class=mi>260</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>112</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span><span class=o>.</span><span class=n>setStyleSheet</span><span class=p>(</span><span class=s2>&#34;background-color: cyan;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span><span class=o>.</span><span class=n>setAlignment</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>Qt</span><span class=o>.</span><span class=n>AlignCenter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_4</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_4</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>460</span><span class=p>,</span> <span class=mi>230</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>40</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QLabel</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>460</span><span class=p>,</span> <span class=mi>260</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>112</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span><span class=o>.</span><span class=n>setStyleSheet</span><span class=p>(</span><span class=s2>&#34;background-color: cyan;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span><span class=o>.</span><span class=n>setAlignment</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>Qt</span><span class=o>.</span><span class=n>AlignCenter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton3</span> <span class=o>=</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QPushButton</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton3</span><span class=o>.</span><span class=n>setGeometry</span><span class=p>(</span><span class=n>QtCore</span><span class=o>.</span><span class=n>QRect</span><span class=p>(</span><span class=mi>773</span><span class=p>,</span> <span class=mi>260</span><span class=p>,</span> <span class=mi>71</span><span class=p>,</span> <span class=mi>31</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton2</span><span class=o>.</span><span class=n>clicked</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>openfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton3</span><span class=o>.</span><span class=n>clicked</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>runPCA</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>reTranslateUI</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>QtCore</span><span class=o>.</span><span class=n>QMetaObject</span><span class=o>.</span><span class=n>connectSlotsByName</span><span class=p>(</span><span class=n>Form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>openfile</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>fname</span> <span class=o>=</span> <span class=n>QFileDialog</span><span class=o>.</span><span class=n>getOpenFileName</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=s2>&#34;打开文件&#34;</span><span class=p>,</span> <span class=s2>&#34;./&#34;</span><span class=p>,</span> <span class=s2>&#34;*.png;;All Files(*)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>img_path</span> <span class=o>=</span> <span class=n>fname</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=n>fname</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;pca&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit2</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>fname</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>s</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>runPCA</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_2</span><span class=o>.</span><span class=n>toPlainText</span><span class=p>()</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>k1</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_1</span><span class=o>.</span><span class=n>toPlainText</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_2</span><span class=o>.</span><span class=n>toPlainText</span><span class=p>()</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>k2</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_2</span><span class=o>.</span><span class=n>toPlainText</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>png</span> <span class=o>=</span> <span class=n>QtGui</span><span class=o>.</span><span class=n>QPixmap</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>img_path</span><span class=p>)</span><span class=o>.</span><span class=n>scaled</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span><span class=o>.</span><span class=n>width</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span><span class=o>.</span><span class=n>height</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span><span class=o>.</span><span class=n>setPixmap</span><span class=p>(</span><span class=n>png</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span> <span class=o>=</span> <span class=n>createDataBase</span><span class=p>(</span><span class=n>root_dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>X_mean</span><span class=p>,</span> <span class=n>X_cen</span><span class=p>,</span> <span class=n>Ei_Face</span> <span class=o>=</span> <span class=n>eigenface</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=mi>300</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>image_No</span> <span class=o>=</span> <span class=n>recognition</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>img_path</span><span class=p>,</span> <span class=n>X_mean</span><span class=p>,</span> <span class=n>X_cen</span><span class=p>,</span> <span class=n>Ei_Face</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;识别的图片是：&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>image_No</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=n>image_No</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>112</span><span class=p>,</span> <span class=mi>92</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cv</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s1>&#39;./result.png&#39;</span><span class=p>,</span> <span class=n>img</span><span class=p>,</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>cv</span><span class=o>.</span><span class=n>IMWRITE_JPEG_QUALITY</span><span class=p>),</span> <span class=mi>95</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>png</span> <span class=o>=</span> <span class=n>QtGui</span><span class=o>.</span><span class=n>QPixmap</span><span class=p>(</span><span class=s1>&#39;./result.png&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>scaled</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span><span class=o>.</span><span class=n>width</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span><span class=o>.</span><span class=n>height</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span><span class=o>.</span><span class=n>setPixmap</span><span class=p>(</span><span class=n>png</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>reTranslateUI</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>Form</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        选择特征获取方式：按值分类 [  ]  按序分类  [   ]
</span></span></span><span class=line><span class=cl><span class=s2>        选择测试图片： [   ]    浏览文件
</span></span></span><span class=line><span class=cl><span class=s2>        测试图片   预测图片   开始识别
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>_translate</span> <span class=o>=</span> <span class=n>QtCore</span><span class=o>.</span><span class=n>QCoreApplication</span><span class=o>.</span><span class=n>translate</span>
</span></span><span class=line><span class=cl>        <span class=n>Form</span><span class=o>.</span><span class=n>setWindowTitle</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;人脸识别--PCA&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_1</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;选择特征获取方式：&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_2</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;按值分类&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label1_3</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;按序分类&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_1</span><span class=o>.</span><span class=n>setPlaceholderText</span><span class=p>(</span><span class=s1>&#39;k1(默认为1)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>textEdit1_2</span><span class=o>.</span><span class=n>setPlaceholderText</span><span class=p>(</span><span class=s1>&#39;k2(≤400)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label2</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;选择测试图片：&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton2</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;浏览文件&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_3</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;测试图片&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_1</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;测试图片&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_4</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;预测图片&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>label3_2</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;预测图片&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pushButton3</span><span class=o>.</span><span class=n>setText</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=s2>&#34;Form&#34;</span><span class=p>,</span> <span class=s2>&#34;开始识别&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span> <span class=o>=</span> <span class=n>QApplication</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>MainWindow</span> <span class=o>=</span> <span class=n>QMainWindow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ui</span> <span class=o>=</span> <span class=n>PcaUI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ui</span><span class=o>.</span><span class=n>setUI</span><span class=p>(</span><span class=n>MainWindow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>MainWindow</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>exec_</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div></div><p>🐱‍🏍学有余力的话 <strong>建议修改界面或添加一些新的功能哦~</strong>
​</p></div></article><footer class=minimal-footer><div class=post-tag><a href=/tags/python/ rel=tag class=post-tag-link>#python</a> <a href=/tags/pca/ rel=tag class=post-tag-link>#pca</a></div><div class=post-category><a href=/posts/ class="post-category-link active">文章</a> |</div></footer></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div></div><script>"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")})</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css><script>if(typeof renderMathInElement=="undefined"){const e=e=>{const t=document.createElement("script");t.defer=!0,t.crossOrigin="anonymous",Object.keys(e).forEach(n=>{t[n]=e[n]}),document.body.appendChild(t)};e({src:"https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js",onload:()=>{e({src:"https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/mhchem.min.js",onload:()=>{e({src:"https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js",onload:()=>{renderKaTex()}})}})}})}else renderKaTex();function renderKaTex(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})}</script><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script>
<script>let imgNodes=document.querySelectorAll("div.post-body img");imgNodes=Array.from(imgNodes).filter(e=>e.parentNode.tagName!=="A"),mediumZoom(imgNodes,{background:"hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)"})</script></body></html>